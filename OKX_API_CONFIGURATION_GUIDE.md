# OKX API 配置完整指南

## 🎯 Overview

本指南将帮助您正确配置OKX API密钥，确保Trading Console能够安全、稳定地连接到OKX交易所。

## 📋 配置清单

在开始之前，请确保您有：
- [ ] 已注册OKX账户并完成KYC认证
- [ ] 了解测试网和生产环境的区别
- [ ] 准备好用于API访问的安全网络环境

## 🔑 第一步：创建API密钥

### 1.1 登录OKX官网

1. 访问 [OKX官网](https://www.okx.com)
2. 登录您的账户
3. 前往 **账户设置** → **API管理**

### 1.2 创建新的API密钥

点击 **创建API密钥** 按钮，系统将引导您完成以下步骤：

#### 步骤1：基本信息
- **API密钥名称**: 为您的API密钥取一个有意义的名称（如：Trading Console）
- **交易密码**: 输入您的交易密码进行验证

#### 步骤2：权限设置 ⭐ **关键配置**

根据您的需求选择权限：

| 权限类型 | 说明 | Trading Console需求 |
|---------|------|-------------------|
| **读取** | 查看账户信息、余额、订单历史 | ✅ **必需** |
| **交易** | 下单、撤单、修改订单 | ✅ **推荐**（用于策略交易） |
| **提现** | 提现资金到外部地址 | ❌ **不推荐**（除非确实需要） |

**建议配置**: 选择 **读取** + **交易** 权限

#### 步骤3：IP白名单设置 ⭐ **重要安全配置**

有两种选择：

**选项A：留空（推荐新手）**
- 不填写任何IP地址
- 允许从任何IP访问（相对不安全但便于使用）

**选项B：配置具体IP（推荐高级用户）**
- 如果您使用固定IP，请添加该IP地址
- 如果您使用代理，请添加代理的出口IP
- 最多可以添加20个IP地址

**如何获取您的当前IP地址**：
1. 访问 [whatismyipaddress.com](https://whatismyipaddress.com)
2. 记录显示的IPv4地址
3. 将此IP添加到白名单中

#### 步骤4：设置Passphrase ⭐ **OKX特有**

- **Passphrase**: 这是OKX特有的安全字段，相当于API密钥的"密码"
- **要求**: 8-32位字符，建议包含大小写字母、数字和特殊字符
- **示例**: `MySecure123!` （请使用您自己的强密码）
- **重要**: 请妥善保存，丢失后无法找回，只能重新创建API密钥

### 1.3 完成创建

创建完成后，系统会显示：
1. **API Key**: 形如 `abc12345-6789-abcd-efgh-123456789012`
2. **Secret Key**: 形如 `ABCD1234EFGH5678IJKL9012MNOP3456`
3. **Passphrase**: 您刚才设置的密码短语

**⚠️ 重要提醒**: 
- Secret Key只会显示一次，请立即保存
- 建议将这些信息保存在安全的密码管理器中

## 🔧 第二步：在Trading Console中配置

### 2.1 打开交易所管理页面

1. 启动Trading Console
2. 登录您的账户
3. 导航到 **交易所** 页面
4. 点击 **添加交易所账户**

### 2.2 填写配置信息

按照以下格式填写：

| 字段 | 说明 | 示例值 | 必填 |
|-----|------|-------|-----|
| **交易所名称** | 选择OKX | `OKX` | ✅ |
| **API Key** | 从OKX复制的API密钥 | `edb07d2e-8fb5-46e8-84b8-5e1795c71ac0` | ✅ |
| **API Secret** | 从OKX复制的密钥 | `CD6A497EEB00AA2DC60B2B0974DD2485` | ✅ |
| **Passphrase** | 您设置的密码短语 | `vf5Y3UeUFiz6xfF!` | ✅ |
| **环境** | 选择正式网或测试网 | `正式网` | ✅ |

### 2.3 配置验证

**重要提示**: 
- 请仔细检查每个字段，确保没有多余的空格或字符
- API Key通常包含连字符(-)
- Secret Key通常是纯字母数字组合
- Passphrase是您自己设置的，区分大小写

## 🧪 第三步：测试连接

### 3.1 基本连接测试

点击 **测试连接** 按钮，系统会：
1. 验证API密钥格式
2. 测试公共API连接
3. 测试私有API认证
4. 检查权限配置

### 3.2 常见错误及解决方案

| 错误信息 | 可能原因 | 解决方案 |
|---------|---------|---------|
| `API密钥无效` | API Key或Secret错误 | 重新检查并复制正确的密钥 |
| `签名验证失败` | Passphrase错误 | 确认Passphrase与OKX设置的一致 |
| `权限不足` | API权限配置不当 | 检查OKX中的权限设置 |
| `IP访问限制` | IP不在白名单中 | 添加当前IP到白名单或清空白名单 |
| `时间戳过期` | 系统时间不同步 | 同步系统时间或重试 |

### 3.3 成功指标

连接成功时，您应该看到：
- ✅ 公共API连接正常
- ✅ 私有API认证成功
- ✅ 能够获取账户余额
- ✅ 能够获取市场数据

## 🛡️ 第四步：安全最佳实践

### 4.1 API密钥安全

- ✅ **定期轮换**: 建议每3-6个月更换一次API密钥
- ✅ **最小权限**: 只授予必要的权限，避免授予提现权限
- ✅ **独立使用**: 不要在多个应用中共享同一个API密钥
- ✅ **安全存储**: 使用密码管理器或加密存储

### 4.2 网络安全

- ✅ **固定IP**: 如果有固定IP，建议配置IP白名单
- ✅ **代理使用**: 如果使用代理，确保代理的安全性
- ✅ **网络监控**: 定期检查API调用日志

### 4.3 监控和维护

- ✅ **定期检查**: 每周检查一次API连接状态
- ✅ **错误监控**: 关注API调用错误和异常
- ✅ **余额监控**: 定期验证余额数据的准确性

## 🔧 第五步：高级配置（可选）

### 5.1 测试网配置

如果您想在测试环境中使用：

1. 访问 [OKX测试网](https://www.okx.com/demo-trading)
2. 创建测试网API密钥
3. 在Trading Console中选择 **测试网** 环境
4. 使用测试网的API密钥配置

### 5.2 多账户配置

Trading Console支持多个OKX账户：

1. 重复上述步骤为每个账户创建API密钥
2. 使用不同的API密钥名称进行区分
3. 在Trading Console中分别添加每个账户

### 5.3 权限验证

您可以验证API权限是否正确配置：

```bash
# 检查读取权限
curl -H "OK-ACCESS-KEY: your-api-key" \
     -H "OK-ACCESS-SIGN: your-signature" \
     -H "OK-ACCESS-TIMESTAMP: timestamp" \
     -H "OK-ACCESS-PASSPHRASE: your-passphrase" \
     "https://www.okx.com/api/v5/account/balance"

# 检查交易权限
curl -H "OK-ACCESS-KEY: your-api-key" \
     -H "OK-ACCESS-SIGN: your-signature" \
     -H "OK-ACCESS-TIMESTAMP: timestamp" \
     -H "OK-ACCESS-PASSPHRASE: your-passphrase" \
     "https://www.okx.com/api/v5/trade/orders-history-archive"
```

## 📞 故障排除

### 常见问题 FAQ

**Q: 为什么我的API密钥总是显示"无效"？**
A: 请检查：
1. API Key、Secret、Passphrase是否完全正确
2. 是否有多余的空格或换行符
3. Passphrase是否区分大小写
4. 是否选择了正确的环境（正式网/测试网）

**Q: 如何知道我的IP是否被限制？**
A: 如果收到"IP访问限制"错误，说明您的当前IP不在白名单中。可以：
1. 将白名单设为空（允许所有IP）
2. 或者将当前IP添加到白名单

**Q: 可以同时使用多个API密钥吗？**
A: 可以，但建议：
1. 为不同的用途创建不同的API密钥
2. 给每个密钥设置最小必要权限
3. 定期轮换和监控使用情况

**Q: 测试网和正式网有什么区别？**
A: 
- **测试网**: 使用虚拟资金，用于测试和学习
- **正式网**: 使用真实资金，进行实际交易
- 两者需要不同的API密钥，不能混用

## 📚 参考资源

- [OKX官方API文档](https://www.okx.com/docs-v5/en/)
- [OKX API权限说明](https://www.okx.com/help/how-to-create-an-api-key)
- [Trading Console技术文档](./README.md)

## 📞 技术支持

如果您在配置过程中遇到问题：

1. **首先检查**: 本指南中的故障排除部分
2. **查看日志**: Trading Console的错误日志通常包含详细的错误信息
3. **联系支持**: 可以通过GitHub Issues或其他渠道寻求帮助

---

**最后更新**: 2025年6月21日
**版本**: v1.0.0
